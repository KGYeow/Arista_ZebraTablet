@page "/reorder"

@using Arista_ZebraTablet.Shared.Application.ViewModels

<PageTitle>Reorder Barcodes</PageTitle>

<!-- Reorder Page Container -->
<MudContainer
    Class="py-6 d-flex flex-column position-relative"
    MaxWidth="MaxWidth.Large"
    Style="flex: 1 1 auto; min-height: 0;"
>
    <!-- Drag-and-Drop List -->
    <MudDropContainer
        T="DropBarcodeItem"
        Items="reorderableBarcodeItems"
        ItemsSelector="@((item, dropzone) => item.Selector == dropzone)"
        ItemDropped="ItemUpdated"
        Class="d-flex flex-wrap flex-grow-1 overflow-auto"
    >
        <!-- The Single Drop Zone with a Header ===== -->
        <ChildContent>
            <MudPaper Elevation="0" Class="flex-grow-1">
                <MudList T="string" Class="d-flex flex-column mud-height-full" ReadOnly>
                    <MudListItem>
                        <MudText Typo="Typo.h6">
                            Reorder Barcodes
                        </MudText>
                    </MudListItem>

                    <!-- The Drop Zone Renders Items in their Current Order -->
                    <MudDropZone @ref="dropZone"
                                 T="DropBarcodeItem"
                                 Identifier="1"
                                 Class="flex-grow-1"
                                 AllowReorder />
                </MudList>
            </MudPaper>
        </ChildContent>

        <!-- Item Renderer -->
        <ItemRenderer>
            <MudListItem T="string" OnClickPreventDefault>
                <MudStack Row AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween">
                    <MudStack Spacing="0">
                        <MudText Typo="Typo.caption">@context.ScanBarcodeItem?.Category</MudText>
                        <MudText Typo="Typo.body1" Class="fw-bold">@context.ScanBarcodeItem?.Value</MudText>
                    </MudStack>
                    <MudItem>
                        <MudIcon Icon="@Icons.Material.Rounded.DragIndicator" Size="Size.Medium" />
                    </MudItem>
                </MudStack>
            </MudListItem>
        </ItemRenderer>
    </MudDropContainer>
</MudContainer>

<!-- Page Actions -->
<MudStack Class="px-6 pb-6" Row Spacing="3">
    <MudButton Color="Color.Success"
               StartIcon="@Icons.Material.Rounded.ContentCopy"
               Variant="Variant.Filled"
               OnClick="() => CopyToClipboard(reorderableBarcodeItems)"
               DropShadow="false"
               FullWidth>
        Copy to Clipboard
    </MudButton>

    <MudButton Color="Color.Error"
               StartIcon="@Icons.Material.Rounded.Close"
               Variant="Variant.Outlined"
               OnClick="CancelReorder"
               FullWidth>
        Cancel
    </MudButton>
</MudStack>